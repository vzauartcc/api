name: Sync Development with Main

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  fast_forward_sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout development branch
        uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8 # v5
        with:
          ref: development
          # Fetch all history to ensure 'main' is available for the check
          fetch-depth: 0

      - name: Configure Git User
        run: |
          git config user.name 'github-actions[bot]'
          git config user.email 'github-actions[bot]@users.noreply.github.com'

      - name: Ensure local main is up-to-date
        # Fetch the latest state of the remote 'main' branch
        run: git fetch origin main

      - name: Fast-Forward Merge main into development
        # If there are unique commits on development, it FAILS (exit code 1),
        run: git merge --ff-only origin/main

      - name: Push Synced development Branch
        run: git push origin development
